{% include mathjax %}

<!-- MarkdownTOC -->

- [10. Чисельні методи розв'язання задачі Коші для звичайних диференційних рівнянь](#10-чисельні-методи-розвязання-задачі-коші-для-звичайних-диференційних-рівнянь)
	- [10.1. Наближені аналітичні методи](#101-наближені-аналітичні-методи)
	- [10.2. Методи типу Ейлера](#102-методи-типу-ейлера)
	- [10.3. Методи типу Рунге-Кутта: TBC](#103-методи-типу-рунге-кутта-tbc)
	- [10.4. Методи з контролем точності на кроці: TBC](#104-методи-з-контролем-точності-на-кроці-tbc)
	- [10.5. Багатокрокові методи розв’язання задачі Коші. Методи Адамса: TBC](#105-багатокрокові-методи-розв’язання-задачі-коші-методи-адамса-tbc)
	- [10.6. Метод невизначених коефіцієнтів побудови багатокрокових методів для розв'язання задачі Коші: TBC](#106-метод-невизначених-коефіцієнтів-побудови-багатокрокових-методів-для-розвязання-задачі-коші-tbc)
	- [10.7. Питання реалізації багатокрокових методів: TBC](#107-питання-реалізації-багатокрокових-методів-tbc)
	- [10.8. Стійкість методів розв'язання задачі Коші: TBC](#108-стійкість-методів-розвязання-задачі-коші-tbc)

<!-- /MarkdownTOC -->

<a id="10-чисельні-методи-розвязання-задачі-коші-для-звичайних-диференційних-рівнянь"></a>
## 10. Чисельні методи розв'язання задачі Коші для звичайних диференційних рівнянь

Постановка задачі: нехай потрібно знайти розв'язок диференційного рівняння з початковими умовами

\begin{equation}
	\label{eq:10.1}
	\frac{\diff u}{\diff t} = f(t, u), \quad t > t_0, \quad u(t_0) = u_0,
\end{equation}

де $$u = (u_1, \ldots. u_m)^\intercal$$, $$f = (f_1, \ldots, f_m)^\intercal$$, $$u_k = u_k(t)$$, $$f_k(t; u_1, \ldots, u_m)$$.

Якщо довільна функція $$f_k$$ неперервна по кожній своїй змінній та по $$u_j$$ вони Ліпшиць-неперервні, тобто

\begin{equation}
	| f_k(t; \ldots, u_j, \ldots) - f_k(t; \ldots, v_j, \ldots) | \le L_j | u_j - v_j |, \quad \forall j, k,
\end{equation}

то розв'язок задачі \eqref{eq:10.1} існує і єдиний.

Нехай задано рівняння $$m$$-ого порядку та початкові умови:

<a id="eq:10.2"></a>
\begin{equation}
	\label{eq:10.2}
	\left\\{
		\begin{aligned}
			& v^{(m)}(t) = F \left(t; v, v', \ldots v^{(m - 1)} \right), \newline
			& t = t_0: v = v_1, v' = v_2, \ldots, v^{(m - 1)} = v_m.
		\end{aligned}
	\right.
\end{equation}

Введемо компоненти вектора $$\vec u$$: $$u_k(t) = v^{(k - 1)}(t)$$. Тоді задача [$$(2)$$](#eq:10.2) записується у вигляді системи \eqref{eq:10.1}:

\begin{equation}
	\left\\{
		\begin{aligned}
			\frac{\diff u_1}{\diff t} &= u_2, \quad u_1(t_0) = v_1, \newline
			\ldots & \ldots, \newline
			\frac{\diff u_{m - 1}}{\diff t} &= u_m, \quad u_{m - 1}(t_0) = v_{m - 1}, \newline
			\frac{\diff u_m}{\diff t} &= F(t; u_1, \ldots, u_m), \quad u_m(t_0) = v_m.
		\end{aligned}
	\right.
\end{equation}

Тому далі, в основному, розглядаються методи розв'язання задачі \eqref{eq:10.1} .

<a id="101-наближені-аналітичні-методи"></a>
### 10.1. Наближені аналітичні методи

Література:

- БЖК, стор.&nbsp;358&ndash;360;

- ЛМС, стор.&nbsp;254&ndash;255.

1. Метод послідовних наближень (_метод Пікара_):

	Потрібно розв'язати диференційне рівняння з відповідними початковими умовами:

	\begin{equation}
		\label{eq:10.1.1}
		\frac{\diff u}{\diff t} = f(x, u), \quad u(t_0) = u_0.
	\end{equation}

	Проінтегруємо \eqref{eq:10.1.1}

	\begin{equation}
	 	\label{eq:10.1.2}
	 	u(t) = u(t_0) + \Int_{t_0}^{t} f(\xi, u(\xi)) \diff \xi.
	\end{equation}

	Задаємо $$u^{(0)}(t)$$ і запишемо ітераційний процес

	\begin{equation}
		\label{eq:10.1.3}
		u^{(k + 1)}(t) = u_0 + \Int_{t_0}^{t} f \left( \xi, u^{(k)}(\xi) \right) \diff \xi, \quad k = 0, 1, \ldots
	\end{equation}
	
	Існує $$T = T(u_0, L)$$ ($$L = \Max_j L_j$$ &mdash; стала Ліпшиця) така, що

	\begin{equation}
		u^{(n)}(t) \xrightarrow[n \to \infty]{} u(t), \quad t \in [t_0, T].
	\end{equation}
	
	Тому $$u(t) \approx u^{(n)}(t)$$.

	**Недолік** методу: необхідно проведення аналітичного інтегрування.

2. _Метод рядів Тейлора_:

	Нехай розв'язок задачі \eqref{eq:10.1.1} можна представити у вигляді ряду

	\begin{equation}
		u(t) = \Sum_{k = 0}^{\infty} \frac{u^{(k)}(t)}{k!} \cdot (t - t_0)^k.
	\end{equation}
	
	Будемо шукати наближення у вигляді скінченої суми:

	\begin{equation}
		\label{eq:10.1.4}
		u(t) \approx u^{N}(t) = \Sum_{k = 0}^{N} \frac{u^{(k)}(t_0)}{k!} \cdot (t - t_0)^k, \quad t \in [t_0, t_1].
	\end{equation}
		
	Для визначення $$u^{(k)}(t_0)$$ диференціюємо рівняння \eqref{eq:10.1.1} по $$t$$:

	\begin{equation}
		u^{(0)}(t_0) = u_0, \quad u^{(1)}(t_0) = f(t_0, u_0),
	\end{equation}

	\begin{equation}
		u^{(2)}(t_0) = f_{t,0} + f_{u,0} f_0, \quad u^{(3)}(t_0) = f_{tt,0} + 2 f_{tu,0} f_0 + f_{uu,0} f_0^2,
	\end{equation}

	і так далі.

	Якщо $$\tau = t_1 - t_0$$ малий параметр, то:

	\begin{equation}
		\left| u(t) = u^N(t) \right| = O(\tau^{N + 1}).
	\end{equation}
	
	**Недоліки** методу:

	- зростання кількості доданків при обчисленні $$u^{(n)}(t_0)$$;

	- необхідно аналітичного диференціювання.

<a id="102-методи-типу-ейлера"></a>
### 10.2. Методи типу Ейлера

Література:

- СГ, стор.&nbsp;214&ndash;218.

Розглянемо задачу Коші:

\begin{equation}
	\label{eq:10.2.1}
	\frac{\diff u}{\diff t} = f(t, u), \quad u(t_0) = u_0.
\end{equation}

Використаємо перше наближення за допомогою рядів Тейлора на проміжку $$t_0 \le t \le t_1$$:

\begin{equation}
	u(t) \approx u^1(t) = u(t_0) + (t - t_0) f(t_0, u_0).
\end{equation}

Обчислимо наближене значення в точці $$t_1$$:

\begin{equation}
	u(t_1) = u_1 \approx u^1(t_1) = u_0 + \tau f(t_0, u_0)
\end{equation}

де $$\tau = t_1 - t_0$$ &mdash; деякий крок. Якщо позначити $$y_1 = u(t_1)$$, $$y_0 = u(t_0)$$, то маємо формулу

\begin{equation}
	y_1 = y_0 + \tau f(t_0, y_0).
\end{equation}

Застосовуючи такий підхід для tn ≤ t ≤ tn+1, отримаємо рекурентну формулу

\begin{equation}
	\label{eq:10.2.2}
	y_{n + 1} = y_1 + \tau f(t_n, y_n),
\end{equation}

для $$n = 0, 1, \ldots$$ з початковими умовами $$y_0 = u_0$$.

Це формула методу Ейлера. Крок інтегрування може змінюватися:

\begin{equation}
	\tau = \tau_n = t_{n + 1} - t_n.
\end{equation}

Геометрична інтерпретація методу Ейлера представлена на рис:

![11](img/11.png)

Його друга назва &mdash; метод ламаних.

Цей метод відноситься до однокрокових, тобто розв'язок на наступному кроці обчислюється тільки по одному значенню на попередньому кроці.

Загальна формула однокрокових методів:

\begin{equation}
	\label{eq:10.2.3}
	y_{n + 1} = y_n + \tilde \Phi(t_n, y_n, f).
\end{equation}

Для методу Ейлера $$\tilde \Phi = \tau f(t_n, y_n)$$.

> **Означення**: Величина $$R(\tau) = y(t_{n + 1}) - u(t_{n + 1})$$, де $$y_{n + 1}$$ обчислюється за формулою \eqref{eq:10.2.3}, причому $$y_n = u(t_n)$$ називається _похибка методу \eqref{eq:10.2.3} на одному кроці_.

Загальна похибка на $$(n + 1)$$-му кроці складається з похибок на всіх попередніх кроках.

> **Означення**: Величина $$z_{n + 1} = y_{n + 1} - u(t_{n + 1})$$, де $$y_{n + 1}$$ і всі попередні $$y_k$$, $$k = 1, 2, \ldots$$ також наближені, називається _похибкою методу_ \eqref{eq:10.2.3}.

Якщо виразити $$y_{n + 1} = u(t_{n + 1}) + z_{n + 1}$$ і підставити в \eqref{eq:10.2.3} , то

\begin{equation}
	u(t_{n + 1}) + z_{n + 1} = u(t_n) + z_n + \tau \tilde \Phi(t_n, u_n + z_n).
\end{equation}

Тоді можна записати рівняння для $$z_n$$:

\begin{equation}
	z_{n + 1} = z_n + \tau \left(- \frac{u_{n + 1} - u_n}{\tau} + \tilde\Phi(t_n, u_n)\right) + \tau \left(\tilde \Phi(t_n, u_n + z_n) - \tilde \Phi(t_n, u_n)\right).
\end{equation}

> **Означення**: Величина $$\psi_n = - \frac{u_{n + 1} - u_n}{\tau} + \tilde \Phi(t_n, u_n)$$ називається _похибкою апроксимації методу_ \eqref{eq:10.2.3} .

Для методу Ейлера

\begin{equation}
	\begin{aligned}
		\psi_n &= - \frac{u_{n + 1} - u_n}{\tau} + f(t_n, u_n) = \newline
		&= - \frac{1}{\tau} \left(u_n + \tau \cdot \frac{\diff u}{\diff t}(t_n) + O(\tau^2) - u_n\right) + f(t_n, u_n) = \newline
		&= - \frac{\diff u}{\diff t}(t_n) + f(t_n, u_n) + O(\tau) = \newline
		&= O(\tau) \xrightarrow[\tau \to 0]{} 0.
	\end{aligned}
\end{equation}

Похибка апроксимації це нев'язка, коли замість $$y$$ в різницеве рівняння \eqref{eq:10.2.3} підставляємо точний розв'язок задачі Коші $$u$$.

> **Означення**: Метод \eqref{eq:10.2.3} має _похибку на одному кроці степеня $$m$$_, якщо $$\vert R_n(\tau) \vert = O(\tau^{m + 1})$$.

> **Означення**: Кажуть, що чисельний метод має _похибку апроксимації степеня $$p$$_, якщо $$\vert \psi_n \vert = O(\tau^p)$$.

Для методу Ейлера похибка на одному кроці

\begin{equation}
	\begin{aligned}
		R_n(\tau) &= y_{n + 1} - u(t_{n + 1}) = \newline
		&= u(t_n) + \tau f(t_n, u(t_n)) - u(t_n + \tau) = \newline
		&= u(t_n) + \tau f(t_n, u(t_n)) - u(t_n) - \tau y'(t_n) + O(\tau^2) = \newline
		&= O(\tau^2).
	\end{aligned}
\end{equation}

Отже $$m = 1$$. Маємо зв'язок похибок: $$\psi(\tau) = R(\tau) / \tau$$ і тому $$p = 1$$.

> **Означення**: Кажуть, що метод \eqref{eq:10.2.3} має степінь точності $$m$$, якщо
>
> \begin{equation}
> \forall n: x_n = y_n - u(t_n) = O(\tau^m).
> \end{equation}

> **Теорема**: Нехай $$f(y, u) \in C^{(1)} (\overline D_T)$$, та $$\vert f_u (t, u) \vert \le L$$, де $$\overline D_T = \{ t_0 < t \le T, \vert u(t) \vert \le K \}$$. Тоді метод Ейлера \eqref{eq:10.2.3} має степінь точності $$m = 1$$ і для нього має місце оцінка 
>
> \begin{equation}
> | z_n | \le M \cdot \Max_j |\psi_j| = O(\tau),
> \end{equation}
>
> де $$M = M(T, L)$$.

_Доведення_: Для $$z$$ маємо задачу

\begin{equation}
	z_{n + 1} = z_n + \tau \psi_n + \tau (f(t_n, u_n + z_n) - f(t_n, u_n)).
\end{equation}

Оцінимо $$z_{n + 1}$$:

\begin{equation}
	\begin{aligned}
		|z_{n+1}| &\le |z_n| + \tau |\psi_n| + \tau L |z_n| + \tau |\psi_n| \le \ldots \newline
		&\le (1 + \tau L)^n |z_0| + \Sum_{j = 0}^{n} \tau (1 + \tau L)^{n - j} |\psi_j| \le \newline
		&\le (1 + \tau L)^n \Max_j |\psi_j| \cdot \Sum_{j = 0}^{n} \tau \le \newline
		&\le T e^{L \tau} \Max_j |\psi_j| \le \newline
		&\le M \Max_j |\psi_j| = O(\tau),
	\end{aligned}
\end{equation}

адже 

\begin{equation}
	(1 + \tau L)^n = (1 + \tau L)^{n \tau / \tau} = (1 + \tau L)^{t_n / \tau} \le (1 + \tau L)^{T / \tau} \le e^{L T}.
\end{equation}

Позначимо $$T e^{LT} = M$$ і отримуємо бажану оцінку. $$\square$$

Таким чином порядок точності методу Ейлера $$m = 1$$.

Метод Ейлера можна вивести із таких міркувань. Інтегруємо \eqref{eq:10.2.1} по $$t$$: $$t_n < t < t_{n + 1]}$$:

\begin{equation}
	\label{eq:10.2.4}
	u(t_{n + 1}) = u(t_n) + \Int_{t_n}^{t_{n+1}} f(t, u(t)) \diff t.
\end{equation}

Застосуємо формулу лівих прямокутників для інтегралу:

\begin{equation}
	\Int_{t_n}^{t_{n+1}} f(t, u(t)) \diff t \approx \tau f(t_n, u(t_n))
\end{equation}

і підставимо в \eqref{eq:10.2.4}. Отримаємо формулу для явного методу Ейлера:

\begin{equation}
	y_{n + 1} = y_n + \tau f(t_n, u(t_n))
\end{equation}

Застосуємо формулу правих прямокутників для інтегрування

\begin{equation}
	\Int_{t_n}^{t_{n+1}} f(t, u(t)) \diff t \approx \tau f(t_{n + 1}, u(t_{n + 1}))
\end{equation}

і підставимо в \eqref{eq:10.2.4}. Отримаємо формулу для неявного методу Ейлера:

\begin{equation}
	\label{eq:10.2.5}
	y_{n + 1} = y_n + \tau f(t_{n + 1}, y_{n + 1}).
\end{equation}

Ці формули $$1$$-го степеня точності по кроку $$\tau$$. Заміняючи інтеграл за квадратурною формулою трапеції:

\begin{equation}
	\Int_{t_n}^{t_{n+1}} f(t, u(t)) \diff t \approx \frac{\tau}{2} (f(t_n, u(t_n)) + f(t_{n + 1}, u(t_{n + 1})))
\end{equation}

ми отримаємо формулу _методу трапеції_ інтегрування задачі Коші:

\begin{equation}
	\label{eq:10.2.6}
	y_{n + 1} = y_n + \frac{\tau}{2} (f(t_n, u(t_n)) + f(t_{n + 1}, u(t_{n + 1}))).
\end{equation}

Це неявний метод.

Обчислимо похибку апроксимації цього методу:

\begin{equation}
	\begin{aligned}
		\psi_n &= - \frac{u_{n + 1} - u_n}{\tau} + \frac{1}{2} (f(t_n, u_n) + f(t_{n + 1}, u_{n + 1})) = \newline
		&= - \frac{1}{\tau} \left( u_{n + 1/2} + \frac{\tau}{2} \cdot \dot u_{n + 1 /2} + \frac{1}{2} \left(\frac{\tau}{2}\right)^2 \ddot u_{n + 1/2} + O(\tau^3) - \right. \newline
		& \quad \left. - u_{n + 1/2} + \frac{\tau}{2} \cdot \dot u_{n + 1/2} - \frac{1}{2} \left(\frac{\tau}{2}\right)^2 \ddot u_{n + 1/2} + O(\tau^3) \right) + \newline
		& \quad + \frac{1}{2} \left( f_{n+1/2} + \frac{\tau}{2} \cdot \dot f_{n + 1/2} + O(\tau^2) + f_{n + 1/2} - \frac{\tau}{2} \cdot \dot f_{n + 1/2} + O(\tau^2) \right) = \newline
		&= - \dot u_{n + 1/2} + O(\tau^2) + f_{n+1/2} = O(\tau^2).
	\end{aligned}
\end{equation}

Таким чином метод трапецій має другий порядок апроксимації.

> **Задача 36**: Показати, що похибка на одному кроці методу трапецій є величина порядку $$O(\tau^3)$$.

Таким чином ми отримали більш точний метод. Недолік методу трапецій &mdash; неявність (треба розв'язувати нелінійне рівняння). Для розв'язання проблеми неявності застосуємо метод предиктор-корректор (предиктор &mdash; попередник, коректор &mdash; уточнювач).

Обчислимо попередньо за явним методом Ейлера

\begin{equation}
	\label{eq:10.2.7}
	\bar y_{n + 1} = y_n + \tau f(t_n, u_n).
\end{equation}

Уточнимо за методом трапецій

\begin{equation}
	\label{eq:10.2.8}
	y_{n + 1} = y_n + \frac{\tau}{2} (f(t_n, y_n) + f(t_{n + 1}, \bar y_{n + 1})).
\end{equation}

Формули \eqref{eq:10.2.7} та \eqref{eq:10.2.8} утворюють _метод Ейлера-Коші_.

Оцінимо похибку на одному кроці

\begin{equation}
	R(\tau) = y_1 + u(t_0 + \tau) = u_0 + \frac{\tau}{2} (f(t_0, y_0) + f(t_0 + \tau, u_0 + \tau f(t_0, u_0))) - u(t_0 + \tau).
\end{equation}

Звідси $$R(0) = 0$$. Далі

\begin{equation}
	\begin{aligned}
		R'(\tau) &= \frac{1}{2} (f(t_0, y_0) + f(t_0 + \tau, y_0 + \tau f_0)) - \newline
		& \quad - \frac{\diff u}{\diff t}(t_0 + \tau) + \frac{\tau}{2} \cdot f_t(t_0 + \tau, u_0 + \tau f(t_0, u_0)) + \newline
		& \quad + \frac{\tau}{2} \cdot f_{tt}(t_0 + \tau, u_0 + \tau f_0(t_0, u_0)) \cdot f(t_0, u_0),
	\end{aligned}
\end{equation}

тому $$R'(0) = \frac{f_0 + f_0}{2} - \frac{\diff u}{\diff t}(t_0) = 0$$.

Наступна похідна

\begin{equation}
	R''(\tau) = f_t(t_0 + \tau, u_0 + \tau f_0) + f_{tt}(t_0 + \tau, u_0 + \tau f_0) \cdot f_0 + \tau (\ldots) - u''(t_0),
\end{equation}

тому $$R''(0) = f_{t,0} + f_{u,0} \cdot f_0 - \frac{\diff^2 u}{d\diff t^2}(t_0) = 0$$,

оскільки $$\frac{\diff^2 u}{\diff t^2} = \frac{\diff}{\diff t} f(t, u) = f_t(\ldots) + f_{tt}(\ldots) \cdot f_0$$.

І, нарешті, $$R'''(0) = \frac{3}{2} \left( f_{tt,0} + 2 f_{tu, 0} + f_{uu} \cdot f_0^2 \right) - u'''(t_0) \ne 0$$. Таким чином похибка на одному кроці має порядок $$p = 2$$.

Ще один метод цього типу:

\begin{equation}
	\label{eq:10.2.9}
	y_{n + 1/2} = y_n + \frac{\tau}{2} \cdot f(t_n, y_n),
\end{equation}

\begin{equation}
	\label{eq:10.2.10}
	y_{n + 1} = y_n + \tau f \left( t_{n + 1/2}, y_{n + 1/2} \right).
\end{equation}

Це модифікований метод Ейлера. На етапі коректор \eqref{eq:10.2.10} використовуємо формулу середніх прямокутників, а предиктор &mdash; це метод Ейлера на інтервалі $$(t_n, t_{n + 1/2})$$.

> **Задача 37**: Показати, що для модифікованого методу Ейлера $$R(\tau) = O(\tau^3)$$, тобто $$m = 2$$.

<a id="103-методи-типу-рунге-кутта-tbc"></a>
### 10.3. Методи типу Рунге-Кутта: TBC

<a id="104-методи-з-контролем-точності-на-кроці-tbc"></a>
### 10.4. Методи з контролем точності на кроці: TBC

<a id="105-багатокрокові-методи-розв’язання-задачі-коші-методи-адамса-tbc"></a>
### 10.5. Багатокрокові методи розв’язання задачі Коші. Методи Адамса: TBC

<a id="106-метод-невизначених-коефіцієнтів-побудови-багатокрокових-методів-для-розвязання-задачі-коші-tbc"></a>
### 10.6. Метод невизначених коефіцієнтів побудови багатокрокових методів для розв'язання задачі Коші: TBC

<a id="107-питання-реалізації-багатокрокових-методів-tbc"></a>
### 10.7. Питання реалізації багатокрокових методів: TBC

<a id="108-стійкість-методів-розвязання-задачі-коші-tbc"></a>
### 10.8. Стійкість методів розв'язання задачі Коші: TBC

[Назад до лекцій](README.md)

[Назад на головну](../README.md)
