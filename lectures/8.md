{% include mathjax %}

<!-- MarkdownTOC -->

- [8. Апроксимування функцій](#8-апроксимування-функцій)
	- [8.1. Постановка задачі апроксимації](#81-постановка-задачі-апроксимації)
	- [8.2. Найкраще рівномірне наближення](#82-найкраще-рівномірне-наближення)
	- [8.3. Приклади побудови БНРН](#83-приклади-побудови-бнрн)
	- [8.4. Найкраще середньоквадратичне наближення](#84-найкраще-середньоквадратичне-наближення)
	- [8.5. Системи ортогональних функцій](#85-системи-ортогональних-функцій)
	- [8.6. Середньоквадратичне наближення періодичних функцій: TBC](#86-середньоквадратичне-наближення-періодичних-функцій-tbc)
	- [8.7. Метод найменших квадратів \(МНК\): TBC](#87-метод-найменших-квадратів-мнк-tbc)
	- [8.8. Згладжуючі сплайни: TBC](#88-згладжуючі-сплайни-tbc)

<!-- /MarkdownTOC -->

<a id="8-апроксимування-функцій"></a>
## 8. Апроксимування функцій

<a id="81-постановка-задачі-апроксимації"></a>
### 8.1. Постановка задачі апроксимації 

Література:

<!-- - ЛМС, стор.&nbsp;8&ndash;13; -->

- Бахвалов, Жидков, Кобельков, стор.&nbsp;164&ndash;166: [pdf](../books/bahvalov-zhidkov-kobelkov-2015/164-166.pdf)

Наближення функцій застосовують у випадках, якщо

- функція складна (трансцендентна або є розв'язком складної задачі) і її замінюють функцією, яка легко обчислюється (найчастіше, поліномом);

- необхідно побудувати функцію неперервного аргументу для функції, яка задана своїми значеннями (таблична);

- таблична функція наближається табличною ж функцією (згладжування).

Інтерполювання не кращий спосіб наближення функцій через розбіжність цього процесу для поліномів. Тим більше доцільність застосування інтерполювання сумнівна, якщо функція таблична, а її значення неточні. Потрібно будувати апроксимуючу функцію з інших міркувань.

Найбільш загальний принцип: наблизити $$f(x)$$ функцією $$\Phi(x)$$ так, щоб досягалася деяка задана точність $$\varepsilon$$:

\begin{equation}
	\left\| f(x) - \Phi(x) \right\| < \varepsilon
\end{equation}

Але розв'язок в такій постановці може не існувати або бути не єдиним.

Загальна постановка задачі наближення така. Нехай маємо елемент $$f$$ лінійного нормованого простору $$R$$. Побудуємо підпростір $$M_n$$, в якому елементи є лінійною комбінацією:

\begin{equation}
	\label{eq:8.1.1}
	\Phi = \Sum_{i = 0}^n c_i \varphi_i \in M_n \subset R
\end{equation}

по елементах лінійно незалежної системи

$$
\begin{equation}
	\left\{ \varphi_i \right\}\void_{i = 0}^\infty, \quad \varphi_i \in R \label{eq:8.1.2}.
\end{equation}
$$

Відхилення $$\Phi \in M_n$$ від $$f \in R$$ є число 

\begin{equation}
	\Delta(f, \Phi) = \| f - \Phi \|.
\end{equation}

Позначимо

\begin{equation}
	\Inf_{\Phi \in M_n} \|f - \Phi\| = \Delta (f).
\end{equation}

> **Означення**. Елемент $$\Phi_0$$ такий, що
>
> \begin{equation}
> \Delta(d, \Phi_0) = \|f - \Phi_0\| = \Inf_{\Phi \in M_n} \|f - \Phi\| = \Delta(f),
> \end{equation}
>
> називається _елементом найкращого наближення_ (ЕНН).

Ясно, що умову точності треба перевіряти на цьому елементі. У випадку її невиконання треба збільшувати кількість елементів $$n$$ в \eqref{eq:8.1.1}.

> **Теорема 1**: Для будь-якого лінійного нормованого простору $$R$$ існує елемент найкращого наближення $$\Phi_0 \in M_n$$.

_Доведення_: Введемо 

\begin{equation}
	F \left( \vec c \right) = F(c_0, c_1, \ldots, c_n) = \|f - \Phi\| = \left\| f - \Sum_{i = 0}^n c_i \varphi_i \right\|.
\end{equation}

Це неперервна функція аргументів $$\vec c = (c_0, c_1, \ldots, c_n)$$. Для елементів, які задовольняють умові 

\begin{equation}
	\label{eq:8.1.4}
	\|\Phi\| > 2 \|f\|, \quad f \in R_1, \quad \Phi \in M_n,
\end{equation}

маємо

\begin{equation}
	F \left( \vec c \right) = \|f - \Phi\| \ge \|\Phi\| - \|f\| > 2 \|f\| - \|f\| = \|f\| > \Delta(f).
\end{equation}

Значить ЕНН $$\Phi_0 \in \{\Phi: \|\Phi\| \le 2 \|f\|\} = \overline{U} \subset M_n$$. За теоремою Кантора $$\exists \Phi_0$$, де $$F \left( \vec c \right)$$ досягає мінімуму. Причому $$\|f - \Phi_0\| \le \|f - \Phi\|$$. $$\square$$

Елементів найкращого наближення в лінійному нормованому просторі може бути і декілька.

> **Означення**: Простір $$R$$ називається _строго нормованим_, якщо з умови
>
> \begin{equation}
> \|f + g\| = \|f\| + \|g\|, \quad \|f\| \ne 0, \quad \|g\| \ne 0
> \end{equation}
>
> випливає, що $$\exists \lambda \ne 0$$ таке, що
>
> \begin{equation}
> g = \lambda f.
> \end{equation}

> **Теорема 2**: Якщо простір $$R$$ строго нормований, то елемент найкращого наближення $$\Phi_0$$ єдиний.

_Доведення_: від супротивного. Нехай існують $$\Phi_0^{(1)} \ne \Phi_0^{(2)}$$ &mdash; два елементи найкращого наближення. Візьмемо $$\alpha \in [0, 1]$$, тоді

$$
\begin{equation}
	\begin{aligned}
		\Delta(f) & \le \left\| f - \alpha \Phi_0^{(1)} - (1 - \alpha) \Phi_0^{(2)} \right\| = \newline
		& = \left\| \alpha \left( f - \Phi_0^{(1)} \right) + (1 - \alpha) \left( f - \Phi_0^{(2)} \right) \right\| \le \newline
		& \le \alpha \left\| f - \Phi_0^{(1)} \right\| + (1 - \alpha) \left\| f - \Phi_0^{(2)} \right\| = \newline
		&= \alpha \Delta (f) + (1 - \alpha) \Delta (f) = \Delta(f).
	\end{aligned}
\end{equation}
$$

Тобто всі &laquo;$$\le$$&raquo; можна замінити на &laquo;$$=$$&raquo; Отримаємо

\begin{equation}
	\begin{aligned}
		& \left\| \alpha \left( f - \Phi_0^{(1)} \right) + (1 - \alpha) \left( f - \Phi_0^{(2)} \right) \right\| = \newline
		& \quad \alpha \left\| f - \Phi_0^{(1)} \right\| + (1 - \alpha) \left\| f - \Phi_0^{(2)} \right\|.
	\end{aligned}
\end{equation}

За припущенням $$\exists \lambda$$ таке, що 

\begin{equation}
	\alpha \left( f - \Phi_0^{(1)} \right) + \lambda (1 - \alpha) \left( f - \Phi_0^{(2)} \right).
\end{equation}

Виберемо $$\alpha = 1 / 2$$. Тоді

\begin{equation}
	f - \Phi_0^{(1)} = \lambda \left( f - \Phi_0^{(2)} \right).
\end{equation}

Оскільки

\begin{equation}
	\left\| f - \Phi_0^{(1)} \right\| = \left\| f - \Phi_0^{(2)} \right\| = \Delta(f),
\end{equation}

то остання рівність має місце тільки для $$\lambda = 1$$. Звідси

\begin{equation}
	f - \Phi_0^{(1)} = f - \Phi_0^{(2)} \implies \Phi_0^{(1)} = \Phi_0^{(2)}.
\end{equation}

Отже, ми отримали протиріччя з припущенням, що і доводить існування єдиного елемента найкращого наближення. $$\square$$

> **Теорема 3**: Гільбертів простір $$H$$ &mdash; строго нормований.

_Доведення_: Нехай

\begin{align}
	\| f + g \| &= \|f\| + \|g\|, \label{eq:8.1.6} \newline
	\| f + g \|^2 &= \|f\|^2 + 2 \|f\| \cdot \|g\| + \|g\|^2.
\end{align}

З іншого боку

\begin{equation}
	\| f + g \|^2 = \langle f + g, f + g\rangle = \|f\|^2 + 2 \langle f, g \rangle + \|g\|^2.
\end{equation}

Звідси $$\|f\| \cdot \|g\| = \langle f, g \rangle$$. Для довільного гільбертового простору $$\langle f, g\rangle \le \|f\| \cdot \|g\|$$.

Таким чином на елементах \eqref{eq:8.1.6} нерівність Коші-Буняковського перетворюється в рівність. Розглянемо

\begin{equation}
	\begin{aligned}
		\|f - \lambda g\|^2 & = \|f\| - 2 \lambda \langle f, g \rangle + \lambda^2 \|g\|^2 = \newline
		& = \|f\|^2 - \lambda \|f\| \cdot \|g\| + \lambda^2 \|g\|^2 = \newline
		&= \left( \|f\| - \lambda \|g\| \right)^2.
	\end{aligned}
\end{equation}

Тоді для $$\lambda = \|f\| / \|g\|$$ маємо $$\|f - λ g\| = 0$$. Звідси $$\exists λ$$: $$f = \lambda g$$, тобто $$Н$$ &mdash; строго нормований. $$\square$$

> **Наслідок**: $$R = H \implies \exists! \Phi_0 \in M_n$$.

> **Приклади** (_строго нормованих просторів_):
> 
> 1. $$L_2([a, b])$$ з нормою $$\|u\| = \sqrt{\Int_a^b u^2 \diff x}$$.
> 
> 2. $$L_p([a, b])$$ з нормою $$\|u\| = \left( \Int_a^b u^p \diff x \right)^{1 / p}$$, $$p > 1$$.

Простір $$C([a,b])$$ не є строго нормованим, але в ньому існує єдиний елемент найкращого наближення (про цей факт в наступному пункті).

<a id="82-найкраще-рівномірне-наближення"></a>
### 8.2. Найкраще рівномірне наближення

Література:

<!-- - ЛМС, стор.&nbsp;66&ndash;82; -->

- Бахвалов, Жидков, Кобельков, стор.&nbsp;178&ndash;187: [pdf](../books/bahvalov-zhidkov-kobelkov-2015/178-187.pdf)

> **Означення**: _Найкраще рівномірне наближення_ &mdash; це наближення в просторі $$R = C([a,b])$$, де $$\|f\|_{C([a,b])} = \Max_{x \in [a, b]} \vert f \vert$$ &mdash; рівномірна метрика.

> **Теорема 1** (_Хаара_): Для того, щоб $$\forall f \in C([a,b])$$ існував єдиний елемент
найкращого рівномірного наближення необхідно і достатньо, щоб система $$\{\varphi_i\}_{i = 0}^\infty$$ була _системою Чебишова_.

> **Означення**: Система $$\{\varphi\}_{i = 1}^\infty$$ називається _системою Чебишова_, якщо елемент $$\Phi_n(x) = \Sum_{i = 0}^n c_i \varphi_i(x)$$ має не більше $$n$$ нулів, причому $$\Sum_{i = 1}^n c_i^2 \ne 0$$. 

> **Наприклад**, системою Чебишова є поліноміальна система $$\{x^i\}\void_{i = 0}^\infty$$.

> **Означення**: Позначимо $$Q_n^0(x)$$ &mdash; _багаточлен найкращого рівномірного наближення_ (далі &mdash; БНРН.). 

Його відхилення від $$f$$:

$$
\begin{equation}
	\Delta(f) = \left\| Q_n^0 (x) - f(x) \right\|_C = \Inf_{Q_n(x)} \left\| Q_n(x) - f(x) \right\|.
\end{equation}
$$

> **Теорема 2** (_Чебишова_): $$Q_n^0(x)$$ &mdash; БНРН неперервної функції $$f(x)$$ тоді та тільки тоді, якщо на відрізку $$[a,b]$$ існує хоча б $$(n + 2)$$-а точки $$a \le x_0 \le \ldots \le x_m \le b$$, $$m \ge n + 1$$ такі, що

\begin{equation}
	\label{eq:8.2.1}
	f(x_i) - Q_n^0(x_i) = \alpha (-1)^i \Delta(f),
\end{equation}

де $$i = \overline{0,m}$$, $$\alpha = \pm 1$$.

> **Означення**: Точки $$\{x_i\}_{i=0}^m$$, які задовольняють умовам теореми Чебишова, називаються _точками чебишовського альтернансу_.

> **Теорема 3**: $$Q_n^0(x)$$ &mdash; БНРН для неперервної функції єдиний.

_Доведення_: Припустимо, існують два БНРН степеня $$n$$: $$Q_n^{(1)}(x) \ne Q_n^{(2)}(x)$$:

\begin{equation}
	\Delta(f) = \left\| f - Q_n^{(1)} \right\|\void_C = \left\| f - Q_n^{(2)} \right\|\void_C.
\end{equation}

Звідси випливає, що

\begin{equation}
	\left\| f - \frac{Q_n^{(1)}(x) + Q_n^{(2)}(x)}{2} \right\| \le \left\| \frac{f - Q_n^{(2)}(x)}{2} \right\| = \Delta(x),
\end{equation}

тобто багаточлен

\begin{equation}
	\frac{Q_n^{(1)}(x) + Q_n^{(2)}(x)}{2}
\end{equation}

також є БНРН. Нехай $$x_0, x_1, \ldots, x_m$$ &mdash; відповідні йому точки чебишовського альтернансу.

Це означає, що

\begin{equation}
	\left| \frac{Q_n^{(1)}(x_i) + Q_n^{(2)}(x_i)}{2} - f(x_i) \right| = \Delta(f),
\end{equation}

або

\begin{equation}
	\label{eq:8.2.2}
	\left( Q_n^{(1)} (x_i) - f(x_i) \right)+ \left( Q_n^{(2)} (x_i) - f (x_i) \right) = 2 \Delta (f).
\end{equation}

Оскільки $$\left\vert Q_n^{(k)} (x_i) - f(x_i) \right\vert \le \Delta(f)$$, $$k = 1,2$$, то \eqref{eq:8.2.2} можливе лише у тому випадку, коли

\begin{equation}
	Q_n^{(1)} (x_i) - f(x_i) = Q_n^{(2)} (x_i) - f(x_i),
\end{equation}

для усіх $$i = \overline{0, n + 1}$$.

Звідки випливає, що $$Q_n^{(1)}(x) = Q_n^{(2)}(x)$$, а це суперечить початковому
припущенню. $$\square$$

<a id="83-приклади-побудови-бнрн"></a>
### 8.3. Приклади побудови БНРН 

Література

- Бахвалов, Жидков, Кобельков, стор.&nbsp;181&ndash;187: [pdf](../books/bahvalov-zhidkov-kobelkov-2015/181-187.pdf)

- Волков, стор.&nbsp;81&ndash;90: [pdf](../books/volkov-1987/81-90.pdf)

Скінченого алгоритму побудови БНРН для довільної функції не існує. Є ітераційний [ЛМС, 73&ndash;79]. Але в деяких випадках можна побудувати БНРН за теоремою Чебишова.

1. Потрібно наблизити багаточленом нульового степеня.

	<a id="img-8-3-1"></a>
	![8.3.1](img/8.3.1.png)
	
	Нехай $$M = \Max_{[a, b]} f(x) = f(x_0)$$, $$m = \Min_{[a,b]} f(x) = f(x_1)$$, тоді $$Q_0(x)$$ &mdash; БНРН має вигляд (див.&nbsp;рис.&nbsp;[11](#img-8-3-1)):

	\begin{equation}
		Q_0(x) = \frac{M + m}{2},
	\end{equation}

	де $$\Delta(x_0) = \frac{M + m}{2}$$, а $$x_0$$, $$x_1$$ &mdash; точки чебишовського альтернансу.

2. Опукла функція $$f(x) \in C([a,b])$$ наближається багаточленом першого степеня

	\begin{equation}
		Q_1(x) = c_0 + c_1 x.
	\end{equation}

	Оскільки $$f(x)$$ опукла, то різниця $$f(x) - (c_0 + c_1 x)$$ може мати лише одну внутрішню точку екстремуму. Тому точки $$a$$, $$b$$ є точками чебишовського альтернансу. Нехай $$\xi$$ третя &mdash; точка чебишовського альтернансу. Згідно з теоремою Чебишова, маємо систему:

	$$
	\begin{equation}
		\left\{
			\begin{aligned}
				f(a) - c_0 - c_1 a &= \alpha \Delta(f), \newline
				f(\xi) - c_0 - c_1 \xi &= - \alpha \Delta(f), \newline
				f(b) - c_0 - c_1 b &= \alpha \Delta(f).
			\end{aligned}
		\right.
	\end{equation}
	$$

	Звідси $$f(b) - f (a) = c_1 (b - a)$$ та $$c_1 = \frac{f(b) - f(a)}{b - a}$$.

	Цю систему треба замкнути, використавши ще одне рівняння з умови: точка $$\xi$$ є точкою екстремуму різниці $$f(x) - (c_0 + c_1 x)$$. Тому для диференційованої функції $$f(x)$$ для визначення $$\xi$$ маємо рівняння (дотична і січна паралельні):

	\begin{equation}
		f'(\xi) = c_1 = \frac{f(b) - f(a)}{b - a}
	\end{equation}

	<a id="img-8-3-2"></a>
	![8.3.2](img/8.3.2.png)

	Геометрично ця процедура виглядає наступним чином (див.&nbsp;[рис.&nbsp;12](#img-8-3-2)). Проводимо січну через точки $$(a, f (a))$$, $$(b, f (b))$$. Для неї тангенс кута дорівнює $$c_1$$. Проводимо паралельну їй дотичну до кривої $$y = f(x)$$, а потім пряму, рівновіддалену від січної та дотичної, яка і буде графіком $$Q_1(x)$$. При цьому $$x_0 = a$$, $$x_1 = \xi$$, $$x_2 = b$$.
	
3. Потрібно наблизити $$f(x) = x^{n + 1}$$, $$x \in [-1,1]$$ багаточленом степеня $$n$$: $$Q_n^0(x)$$. Введемо

	\begin{equation}
		\overline P_{n + 1}(x) = x^{n + 1} - Q_n(x) = x^{n + 1} - a_1 x^n - \ldots
	\end{equation}

	Далі

	$$
	\begin{equation}
		\begin{aligned}
			\Delta(f) &= \Inf_{Q_n(x)} \left\| x^{n + 1} - Q_n^0(x) \right\|_C = \newline
			&= \Inf_{\overline{P}_{n + 1}} \left\| \overline{P}_{n + 1} - 0 \right\|_C = \newline
			&= \left\| \overline{T}_{n + 1}(x) \right\|.
		\end{aligned}
	\end{equation}
	$$

	Звідси

	$$
	\begin{equation}
		x^{n + 1} - Q_n^0(x) = \overline T_{n + 1}(x),
	\end{equation}
	$$

	або

	$$
	\begin{equation}
		Q_n^0(x) = x^{n + 1} - \overline T_{n + 1}(x).
	\end{equation}
	$$

	> **Задача 25**: Для прикладу&nbsp;3 вказати точки чебишовського альтернансу $$\{x_i\}$$, $$i = \overline{0, n + 1}$$.

4. Потрібно наблизити $$f(x) = P_{n + 1}(x) = a_0 + \ldots + a_{n + 1} x^{n + 1}$$, $$a_{n + 1} \ne 0$$, $$x \in [a, b]$$ БНРН степеня $$n$$. Запишімо його у вигляді:

	\begin{equation}
		Q_n^0(x) = P_{n + 1}(x) - a_{n + 1}(x) \overline T_{n + 1}^{[a, b]}
	\end{equation}


	де $$\overline T_{n + 1}^{[a, b]}(x)$$ &mdash; нормований багаточлен Чебишова на проміжку $$x \in [a,b]$$.

	Дійсно це БНРН: вираз у правій частині є багаточленом степеня $$n$$, оскільки коефіцієнт при $$x^{n + 1}$$ дорівнює нулю, а його нулі

	\begin{equation}
		x_k = \frac{b + a}{2} + \frac{b - a}{2} \cdot t_k,
	\end{equation}

	де 

	\begin{equation}
		t_k = \cos \left( \frac{(2 k + 1) \pi}{2 (n + 1)} \right),
	\end{equation}

	для $$k = \overline{0,n}$$ є точками чебишевського альтернасу для $$Q_n^0(x)$$.

	> **Задача 26**: Показати, що для $$f(x)$$ парної (непарної) функції БНРН це багаточлен по парних (непарних) степенях $$x$$.

5. Телескопічний метод. Дуже часто БНРН точно знайти не вдається. В таких випадках шукається багаточлен, близький до нього. Бажано щоб цей багаточлен був невисокого степеня (менше арифметичних операцій на його обчислення) Спочатку будують такий багаточлен 

	\begin{equation}
		P_n(x) = \Sum_{j = 0}^n a_j x^j,
	\end{equation}

	щоб відхилення від $$f(x)$$ була достатньо малою. (наприклад меншою за $$\varepsilon / 2$$).

	Можна це зробити, наприклад, за формулою Тейлора. Потім наближають багаточлен $$P_n(x)$$ багаточленом найкращого рівномірного наближення $$P_{n-1}(x)$$ (за алгоритмом п.&nbsp;4; для простоти $$x \in [-1,1]$$):

	\begin{equation}
		P_{n - 1}(x) = P_n(x) - a_n T_n(x) 2^{1 - n}.
	\end{equation}

	Оскільки $$\vert T_n(x) \vert \le 1$$ на відрізку $$[-1, 1]$$, то

	\begin{equation}
		| P_{n - 1}(x) - P_n(x) | \le |a_n| \cdot 2^{1 - n}.
	\end{equation}

	Далі наближають багаточлен $$P_{n-1}(x)$$ багаточленом найкращого рівномірного наближення $$P_{n - 2}(x)$$ і т.&nbsp;д. Пониження степеня продовжується до тих пір, поки сумарна похибка від таких послідовних апроксимацій залишається меншою за задане мале число $$\varepsilon$$.

<a id="84-найкраще-середньоквадратичне-наближення"></a>
### 8.4. Найкраще середньоквадратичне наближення

Література:

- БЖК, стор.&nbsp;156&ndash;166;

- ЛМС, стор.&nbsp;53&ndash;58.

Наблизимо функцію $$f(x) \in H$$ з гільбертового простору $$H$$ функціями із скінченно-вимірного підпростору $$M_n$$ простору $$H$$. Тут $$H$$ &mdash; гільбертів простір із скалярним добутком $$\langle u, r \rangle$$, норма і відстань для якого визначаються формулами:

\begin{equation}
	\|u\| = \sqrt{\langle u, u \rangle}, \quad \Delta(u, v) = \|u - v\|.
\end{equation}

Побудуємо

\begin{equation}
	\label{eq:8.4.1}
	u = \Sum_{i=0}^n c_i \varphi_i \in M_n \subset H,
\end{equation}

де $$\{\varphi_i\}\void_{i=0}^\infty$$ &mdash; лінійно-незалежна система елементів з $$H$$.

> **Означення**: _Елементом найкращого середньоквадратичного наближення_ (в подальшому ЕНСКН) називатимемо $$\Phi_0$$ такий, що
>
> \begin{equation}
> \|f - \Phi_0\| = \sqrt{\langle f - \Phi_0, f - \Phi_0 \rangle} = \Inf_{\Phi \in M_n} \|f - \Phi\|.
> \end{equation}

<a id="теорема-8-4-1"></a>
> **Теорема 1**: Нехай $$f \in H$$, $$\Phi_0 \in M_n$$ &mdash; елемент найкращого середньоквадратичного наближення, тобто
>
> \begin{equation}
> \|f - \Phi_0\| = \Inf_{\Phi \in M_n} \|f - \Phi\|,
> \end{equation}
>
> тоді 
>
> \begin{equation}
> \label{eq:8.4.2}
> \forall \Phi \in M_n: \quad \langle f - \Phi_0, \Phi \rangle = 0.
> \end{equation}

_Доведення_:

Нехай \eqref{eq:8.4.2} не виконується, тобто $$\exists \Phi_1 \in M_n$$:

\begin{equation}
	\langle f - \Phi_0, \phi_1 \rangle = \alpha \ne 0.
\end{equation}

Без обмеження загальності можемо вважати, що $$\|\Phi_1\| = 1$$.

Побудуємо $$\Phi_2 = \Phi_0 + \alpha \Phi_1$$, тоді

\begin{equation}
	\begin{aligned}
		\|f - \Phi_2\|^2 &= \langle f - \Phi_2, f - \Phi_2 \rangle = \newline
		&= \|f - \Phi_0\|^2 - \alpha^2 < \|f - \Phi_0\|^2.
	\end{aligned}
\end{equation}

Отже, елемент $$\Phi_2$$ кращий за елемент найкращого середньоквадратичного наближення $$\Phi_0$$. А це суперечність. $$\square$$

> **Наслідок**: $$f = \Phi_0 + \nu$$, де $$\Phi_0 \in M_n$$, а $$\nu \perp M_n$$ (поправка $$\nu$$ &mdash; з ортогонального доповнення до $$M_n$$).

Знайти ЕНСКН

\begin{equation}
	\label{eq:8.4.3}
	\Phi_0 = \Sum_{i = 0}^n c_i \varphi_i
\end{equation}

означає знайти коефіцієнти $$c_i$$.

Для виконання \eqref{eq:8.4.2} достатньо, щоб

\begin{equation}
	\label{eq:8.4.4}
	\langle f - \Phi_0, \varphi_k \rangle = 0, \quad k = \overline{0, n}.
\end{equation}

Підставимо \eqref{eq:8.4.3} у формулу \eqref{eq:8.4.4}:

\begin{equation}
	\langle f - \Sum_{i = 0}^n c_i \varphi_i, \varphi_k \rangle = 0.
\end{equation}

Таким чином маємо СЛАР для $$c_i$$:

\begin{equation}
	\label{eq:8.4.5}
	\Sum_{i=0}^n c_i \langle \varphi_i, \varphi_k \rangle = \langle f, \varphi_k \rangle ,\quad k = \overline{0, n}.
\end{equation}

З [теореми $$1$$](#теорема-8-4-1) витікає лише достатність умов \eqref{eq:8.4.5} для знаходження коефіцієнтів $$c_i$$. Розглянемо задачу

\begin{equation}
	\|f - \Phi_0\| = \Inf_{\Phi \in M_n} \|f - \Phi\|,
\end{equation}

як задачу мінімізації функції багатьох змінних:

\begin{equation}
	F(a_0, \ldots, a_n) = \|f - \Phi\|^2 = \left\| f - \Sum_{i=0}^n a_i \varphi_i \right\|^2 \to \min.
\end{equation}

Умови мінімуму цієї функції приводять до \eqref{eq:8.4.5}.

> **Задача 27**: Показати, що для коефіцієнтів $$c_i$$ елемента найкращого середньо-квадратичного наближення умови \eqref{eq:8.4.5} є необхідними та достатніми.

Матриця СЛАР \eqref{eq:8.4.5} складається з елементів $$g_{ik}=\langle \varphi_i, \varphi_k\rangle$$, тобто це матриця Грамма: $$G = (g_{ik})^n_{i,k=0}$$. Оскільки це матриця Грамма лінійно-незалежної системи, то $$\det G \ne 0$$det, що ще раз доводить існування та єдиність ЕНСКН. Оскільки $$G^\intercal = G$$, то для розв'язку цієї системи використовують метод квадратних коренів.

Якщо взяти $$x \in [0,1]$$ та $$\varphi_i(x) = x^i$$, $$i = \overline{0, n}$$, $$H = L_2(0,1)$$, то

\begin{equation}
	g_{ik} = \Int_0^1 x^i x^k \diff x = \frac{1}{i + k + 1}, \quad i, k = \overline{0, n}.
\end{equation}

Це матриця Гілберта, яка є погано обумовленою: $$\text{cond} G \approx  10^7$$, $$n = 6$$. Праві частини

\begin{equation}
	f_k = \langle f, \varphi_k \rangle = \Int_0^1 f(x_i) x^k \diff x
\end{equation}

як правило, обчислюються наближено, тому похибки обчислення $$c_i$$ можуть бути великими.

Що робити? Якщо вибирати систему $$\{\varphi_i\}^\infty_{i=0}$$ ортонормованою, тобто

\begin{equation}
	\langle \varphi_i, \varphi_k \rangle  = \delta_{ik} = \begin{cases}
		1, & i = k, \newline
		0, & i \ne k,
	\end{cases}
\end{equation}

то система \eqref{eq:8.4.5} має явний розв'язок

\begin{equation}
	\label{eq:8.4.6}
	\Phi_0 = \Sum_{i=0}^n \langle f, \varphi_i \rangle \cdot \varphi_i.
\end{equation}

Якщо $$\{\varphi_i\}$$ &mdash; повна ортонормована система, то довільну функцію можна представити у вигляді ряду Фур'є:

\begin{equation}
	f = \Sum_{i=0}^\infty \langle f, \varphi_i \rangle \cdot \varphi_i,
\end{equation}

і 

\begin{equation}
	f - \Phi_0 = \Sum_{i = n + 1}^\infty c_i \varphi_i = \nu
\end{equation}

&mdash; залишок (похибка). Таким чином ЕНСКН є відрізком ряду Фур'є. Далі

\begin{equation}
	\begin{aligned}
		\|f - \Phi_0\|^2 &= \langle f - \Phi_0, f - \Phi_0 \rangle = \newline
		&= \|f\|^2 - 2 \langle f, \Phi_0 \rangle + \|\Phi_0\|^2 = \newline
		&= \|f\|^2 - 2 \|\Phi_0\|^2 - 2 \langle \nu, \Phi_0\rangle + \|\Phi_0\| = \newline
		&= \|f\|^2 - \|\Phi_0\|^2 = \newline
		&= \Sum_{i = 0}^\infty c_i^2 - \Sum_{i=0}^n c_i^2 = \newline
		&= \Sum_{i = n + 1}^\infty c_i^2 \xrightarrow[n \to \infty]{} 0.
	\end{aligned}
\end{equation}

Останнє випливає з відповідної теореми математичного аналізу. Таким чином, якщо $$\{\varphi_i\}^\infty_{i=0}$$ &mdash; повна ортонормована система, то

\begin{align}
	\Sum_{i = n + 1}^\infty c_i^2 &\xrightarrow[n \to \infty]{} 0, \newline
	\Phi_0^{(n)} &\xrightarrow[n \to \infty]{} f,
\end{align}

Значить вірна

> **Теорема 2**: В гільбертовому просторі $$H$$ послідовність ЕНСКН $$\left\{\Phi_0^{(n)}\right\}$$ по повній ортонормованій системі $$\{\varphi_i\}^\infty_{i=0}$$ збігається до $$f$$ .

> **Зауваження 1**: Відхилення можна обчислити за формулою:
>
> \begin{equation}
> \begin{aligned}
> \Delta^2(f) &= \|f - \Phi_0\|^2 = \newline
> &= \|f\|^2 - 2 \langle f, \Phi_0 \rangle + \|\Phi_0\|^2 = \newline
> &= \|f\|^2 - \|\Phi_0\|^2 = \|f\|^2 - \Sum_{i = 0}^n c_i^2.
> \end{aligned} 
> \end{equation}

Якщо $$\{\varphi_i\}^\infty_{i=0}$$ &mdash; ортогональна система, але не нормована, тобто $$\langle \varphi_i, \varphi_k \rangle = \delta_{ik} \|\varphi_i\|^2$$, то

\begin{align}
	c_i &= \frac{\langle f, \varphi_i \rangle}{\|\varphi_i\|^2}, \newline
	\Phi_0 &= \Sum_{i = 0}^n \frac{\langle f, \varphi_i \rangle}{\|\varphi_i\|^2} \cdot \varphi_i, \newline
	\|f - \Phi_0\|^2 &= \|f\|^2 - \Sum_{i = 0}^n \frac{c_i^2}{\|\varphi_i\|^2}.
\end{align}

Для функції $$f(x)$$, щоб побудувати ЕНСКН покладемо $$H = L_{2,\alpha}([a,b])$$, в якому скалярний добуток виберемо наступним чином

\begin{equation}
	\langle u, v \rangle = \Int_a^b u(x) v(x) \diff \alpha(x),
\end{equation}

де $$\alpha(x)$$ &mdash; зростаюча функція. Можливі випадки: 

1. $$\alpha(x) \in C^1([a,b])$$, тоді $$\diff \alpha(x) = \rho(x) \diff x > 0$$ та 

	\begin{equation}
		\langle u, v \rangle = \Int_a^b \rho(x) u(x) v(x) \diff x.
	\end{equation}

2. $$\alpha(x)$$ &mdash; функція стрибків, $$\alpha(x) = \alpha(x_k - 0)$$, де $$x_{k-1} \le x \le x_k$$, $$k = \overline{1,n}$$. Якщо ввести $$\rho_k = \alpha(x_k + 0) - \alpha(x_k - 0)$$, то

	\begin{equation}
		\langle u, v \rangle = \Sum_{k = 1}^n \rho_k u(x_k) v(x_k).
	\end{equation}

Перший вибір $$\alpha(x)$$ використовується при апроксимації функцій неперервного аргументу, а другий &mdash; для табличних функцій.

<a id="85-системи-ортогональних-функцій"></a>
### 8.5. Системи ортогональних функцій

Література:

- БЖК, стор.&nbsp;19&ndash;102;

- ЛМС, стор.&nbsp;388&ndash;382.

Як вибирати ортонормальну або ортогональну систему функцій $$\{\varphi_i\}^\infty_{i = 0}$$?

Розглянемо деякі з найбільш вживаних таких систем.

1. Якщо $$H = L_2([-1,1])$$; $$\rho \equiv 1$$ (ваговий множник), то $$\varphi_i(x) = L_i(x)$$ &mdash; система _багаточленів Лежандра_, які мають вигляд

	\begin{equation}
		L_n(x) = \frac{1}{2^n n!} \cdot \frac{\diff^n}{\diff x^n } \cdot (x^2 - 1)^n.
	\end{equation}
	
	Використовують також рекурентні формули

	\begin{equation}
		(n + 1) L_{n + 1}(x) = (2 n + 1) x L_n(x) - n L_{n - 1}(x),
	\end{equation}
	
	до яких додаємо умови

	\begin{equation}
		L_0(x) = 1, \quad L_1(x) = x.
	\end{equation}
	
	Це ортогональна система в тому сенсі, що

	\begin{equation}
		\langle L_i, L_k \rangle = \Int_{-1}^1 L_i(x) L_k(x) \diff x = \delta_{ik} \|L_i(x)\|^2, 
	\end{equation}

	де $$\|L_i(x)\|^2 = \frac{2}{2 i + 1}$$ і тому $$c_i = \frac{\langle f, L_i \rangle}{\|L_i\|^2} = \frac{2 i + 1}{2} \langle f, L_i \rangle$$.

	> **Зауваження**: Якщо потрібно побудувати наближення на довільному проміжку $$(a, b)$$, то бажано перейти до проміжку $$(-1, 1)$$, тобто по $$f(x)$$ на $$[a, b]$$ побудувати $$f(t)$$ з $$t \in [-1, 1]$$ заміною $$x = A t + B$$, $$t = \alpha x + \beta$$ та для побудови багаточлена НСКН для $$f(t)$$ використати багаточлени Лежандра $$L_i(t)$$.

	Можна робити навпаки &mdash; систему багаточленів перевести з $$[a, b]$$ на $$[-1, 1]$$, але це вимагає більше обчислень і процес побудови ЕНСКН складніше.

2. Якщо $$H = L_{2, \rho} ([-1,1])$$, $$\rho(x) = 1 / \sqrt{1 - x^2}$$, скалярний добуток 

	\begin{equation}
		\langle u, v \rangle = \Int_{-1}^1 \frac{u(x) v(x)}{\sqrt{1 - x^2}} \diff x
	\end{equation}

	(це невласні інтеграли другого роду), то $$\varphi_i(x) = T_i(x)$$, де $$\{T_i(x)\}$$ &mdash; система ортогональних _багаточленів Чебишова_ 1-го роду, які мають вигляд 

	\begin{equation}
		T_n(x) = \cos(n \arccos(x)).
	\end{equation}
	
	Рекурентна формула для цих багаточленів:

	\begin{equation}
		T_{n + 1}(x) = 2 x T_n(x) - T_{n - 1}(x),
	\end{equation}
	
	до якої додаємо умови $$T_0 = 1$$, $$T_1 = x$$.

	Для цієї системи

	\begin{equation}
		\|T_n\|^2 = \begin{cases}
			\pi, & n = 0, \newline
			\pi / 2, & n = 1, 2, \ldots
		\end{cases}
	\end{equation}
	
3. $$H$$ гільбертів простір з ваговим множником $$\rho(x) = (1 - x)^\alpha (1 + x)^\beta$$. Система $$\varphi_i(x) = P_n^{(\alpha, \beta)}(x)$$ &mdash; _багаточленів Якобі_, $$\alpha, \beta > -1$$ ($$\alpha$$, $$\beta$$ &mdash; числові параметри) ортогональна в сенсі скалярного добутку

	\begin{equation}
		\langle u, v \rangle = \Int_{-1}^1 (1 - a)^\alpha (1 + x)^\beta u(x) v(x) \diff x.
	\end{equation}
	
	Ця система є узагальненням випадків 1. та 2. 

	Диференціальна формула для багаточленів:

	\begin{equation}
		P_n^{(\alpha, \beta)}(x) = \frac{(-1)^n}{2^n n!} (1 - x)^{-\alpha} (1 + x)^{-\beta} \frac{\diff^n}{\diff x^n} \left( (1 - x)^{n + \alpha} (1 + x)^{n + \beta} \right).
	\end{equation}
	
	Рекурентна формула:
	
	\begin{align}
		& 2 (n + 1) (n + \alpha + \beta + 1) (2 n + \alpha + \beta) P_{n + 1}^{(\alpha, \beta)}(x) = \newline
		& \quad = (2 n + \alpha + \beta + 1) ( (2 b + \alpha + \beta) (2 n + \alpha + \beta + 2) x + \alpha^2 - \beta^2) P_n^{(\alpha, \beta)}(x) - \newline
		& \qquad - 2 (n + \alpha) (n + \beta) (2 n + \alpha + \beta + 2) P_{n - 1}^{(\alpha, \beta)}(x),
	\end{align}

	де $$P_0^{(\alpha, \beta)} = 1$$, $$P_{-1}^{(\alpha, \beta)} = 0$$, і
	
	\begin{equation}
		\left\| P_n^{(\alpha, \beta)} \right\|^2 = \frac{2^{\alpha + \beta + 1} \Gamma(\alpha + n + 1) \Gamma(\beta + n + 1)}{n! (\alpha + \beta + 2 n + 1) \Gamma(\alpha + \beta + n + 1)},
	\end{equation}

	та

	\begin{equation}
		\Gamma(z) = \Int_0^\infty e^{-t} t^{z - 1} \diff t,
	\end{equation}

	а $$\Gamma(z + 1) = z \cdot \Gamma(z)$$, $$\Gamma(n + 1) = n!$$.

	Коли $$\alpha = \beta = 0$$: $$P_n^{(0, 0)}(x) = L_n(x)$$, а для $$\alpha = \beta = - 1 / 2$$: $$P_n^{(-1/2, -1/2)}(x) = T_n(x)$$.

4. $$H = L_{2, \rho} ([0, \infty))$$, $$\rho(x) = x^\alpha e^{-x}$$, $$\alpha > -1$$.

	Цьому ваговому множнику відповідає _система багаточленів Лагерра_ $$\varphi_i(x) = L_i^\alpha(x)$$, які задаються диференціальною формулою:

	\begin{equation}
		L_n^\alpha(x) = (-1)^n x^{-\alpha} e^x \frac{\diff^n}{\diff x^n} \left(x^{\alpha + n} e^{-x}\right)
	\end{equation}
	
	або в рекурентній формі
	
	\begin{equation}
		(n + 1) L_{n + 1}^\alpha = (2 n + \alpha + 1 - x) L_n^\alpha - (n + \alpha) L_{n - 1}^\alpha,
	\end{equation}
	
	де $$L_0^\alpha = 1$$, $$L_{-1}^\alpha = 0$$ та з нормою $$\|L_n^\alpha\|^2 = n! \cdot \Gamma(\alpha + n + 1)$$.
	
5. $$H = L_{2,\alpha}((-\infty,\infty))$$, $$\rho(x) = e^{-x^2}$$. Систему ортогональних функцій вибираємо як систему _багаточленів Ерміта_ $$\varphi_i(x) = H_i(x)$$, які задаються диференціальною формулою:

	\begin{equation}
		H_n(x) = (-1)^n e^{x^2} \frac{\diff^n}{\diff x^n} e^{-x^2},
	\end{equation}
	
	або в рекурентній формі

	\begin{equation}
		H_{n + 1}(x) = 2 x H_n(x) - 2 n H_{n - 1}(x)
	\end{equation}

	де $$H_0 = 1$$, $$H_{-1} = 0$$ та $$\|H_n\|^2 = 2^n n! \sqrt{\pi}$$.

6. $$H = L_2([0,2\pi])$$, $$\rho(x) \equiv 1$$, $$f(x) = f (x + 2\pi)$$. $$f(x)$$ &mdash; $$2\pi$$-періодичні функції. За систему ортонормованих функцій вибираємо _тригонометричну
систему_ 

	\begin{align}
		\varphi_0(x) &= \frac{1}{\sqrt{2\pi}}, \newline
		\varphi_{2 k - 1}(x) &= \frac{\cos(k x)}{\sqrt{\pi}}, \newline
		\varphi_{2 k}(x) &= \frac{\sin(k x)}{\sqrt{\pi}}.
	\end{align}

	Елемент найкращого середньоквадратичного наближення представляє собою тригонометричний багаточлен

	\begin{equation}
		\Phi_0(x) = T_n(x) = \frac{a_0}{2} + \Sum_{k = 1}^n (a_k \cos(k x) + b_k \sin(k x)),
	\end{equation}
	
	формули для обчислення цих коефіцієнтів наведені в наступному пункті.

7. Якщо потрібно апроксимувати табличну функцію, то $$H = \ell_2$$, $$x_i = i$$, $$i = \overline{0, N}$$,

	\begin{equation}
		\langle u, v \rangle = \frac{1}{N + 1} \Sum_{i = 0}^N u_i v_i,
	\end{equation}

	і за систему ортогональних функцій вибираємо наступну систему багаточленів: $$\varphi_k(x) = p_k^{(N)}(x)$$, $$k = \overline{0,m}$$ ($$m \le N$$) &mdash; систему _багаточленів Чебишова дискретного аргументу_, які задається формулою

	\begin{equation}
		p_k^{(N)}(x) = \Sum_{j = 0}^k \frac{(-1)^j C_k^j C_{k + j}^j}{N^{(j)}} \cdot x^{(j)}
	\end{equation}
	
	де $$x^{(j)} = x (x - 1) \ldots (x - j + 1)$$ &mdash; факторіальний багаточлен; $$C_k^j$$ &mdash; число сполук.

	Рекурентна формула:

	\begin{equation}
		\frac{(m + 1) (N - m)}{2 (2 m + 1)} \cdot p_{m + 1}^{(N)} = \left( \frac{N}{2} - x \right) p_m^{(N)} - \frac{m (N + m + 1)}{2 (2 m + 1)} \cdot p_{m - 1}^{(N)},
	\end{equation}

	з початковими значеннями $$p_0^{(N)} = 1$$, $$p_{-1}^{(N)} = 0$$.
	
	Наприклад $$p_1^{(N)} = 1 - \frac{2 x}{N}$$, $$p_2^{(N)} = 1 - \frac{6 x}{N} + \frac{6 x^2}{N (N - 1)}$$.

	У випадку, якщо задані вузли $$t_i = t_0 + i h$$, $$i = \overline{0, N}$$, то робимо заміну $$x_i = \frac{t_i - t_0}{h} = i$$.

<a id="86-середньоквадратичне-наближення-періодичних-функцій-tbc"></a>
### 8.6. Середньоквадратичне наближення періодичних функцій: TBC

<a id="87-метод-найменших-квадратів-мнк-tbc"></a>
### 8.7. Метод найменших квадратів (МНК): TBC

<a id="88-згладжуючі-сплайни-tbc"></a>
### 8.8. Згладжуючі сплайни: TBC

[Назад до лекцій](README.md)

[Назад на головну](../README.md)
