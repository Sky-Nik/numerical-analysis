{% include mathjax %}

<!-- MarkdownTOC -->

- [1. Аналіз похибок заокруглення](#1-аналіз-похибок-заокруглення)
	- [1.1. Види похибок](#11-види-похибок)
	- [1.2. Підрахунок похибок в ЕОМ](#12-підрахунок-похибок-в-еом)
	- [1.3. Підрахунок похибок обчислення значення функції](#13-підрахунок-похибок-обчислення-значення-функції)

<!-- /MarkdownTOC -->


<a id="1-аналіз-похибок-заокруглення"></a>
## 1. Аналіз похибок заокруглення

Література:
- Самарский, Гулин, 16&ndash;25: [djvu](../books/samarskyi-gulin-1989.djvu), [pdf](../books/samarskyi-gulin-1989-16-25.pdf);
- Березин, Жидков, 16&ndash;35: [djvu](../books/berezin-zhidkov-i-1962.djvu), [pdf](../books/berezin-zhidkov-i-1962-16-35.pdf).

<a id="11-види-похибок"></a>
### 1.1. Види похибок

Нехай необхідно розв'язати рівняння

\begin{equation}
	\label{eq:1.1.1}
	A u = f.
\end{equation}

За рахунок неточно заданих вхідних даних насправді ми маємо рівняння

\begin{equation}
	\label{eq:1.1.2}
	\widetilde{A} \widetilde{u} = \widetilde{f}.
\end{equation}

Назвемо $$\delta_1 = u - \widetilde{u}$$ _неусувною похибкою_.

Застосування методу розв'язання $$\eqref{eq:1.1.2}$$ приводить до рівняння

\begin{equation}
	\label{eq:1.1.3}
	\widetilde{A}_h \widetilde{u}_h = \widetilde{f}_h,
\end{equation}

де $$h > 0$$ &mdash; малий параметр. Назвемо $$\delta_2 = \widetilde{u} - \widetilde{u}_h$$ _похибкою методу_.

Реалізація методу на ЕОМ приводить до рівняння

\begin{equation}
	\label{eq:1.1.4}
	\widetilde{A}_h^\star \widetilde{u}_h^\star = \widetilde{f}_h^\star.
\end{equation}

Назвемо $$\delta_3 = \widetilde{u}_h - \widetilde{u}_h^\star$$ _похибкою заокруглення_.

Тоді _повна похибка_ $$\delta = u - \widetilde{u}_h^\star = \delta_1 + \delta_2 + \delta_3$$.

**Визначення:** кажуть, що задача $$\eqref{eq:1.1.1}$$ _коректна_, якщо

1. $$\forall f \in F$$: $$\exists! u \in U$$;

2. Задача $$\eqref{eq:1.1.1}$$ _стійка_, тобто $$\forall \varepsilon > 0$$: $$\exists \delta > 0$$: $$\left\| A - \widetilde{A} \right\| < \delta, \left\| f - \widetilde{f} \right\| < \delta \implies \left\| u - \widetilde{u} \right\| < \varepsilon$$.

Якщо задача $$\eqref{eq:1.1.1}$$ некоректна, то або розв'язок її не існує, або він
неєдиний, або він нестійкий, тобто $$\exists \varepsilon > 0$$: $$\forall \delta > 0$$: $$\left\| A - \widetilde{A} \right\| < \delta, \left\| f - \widetilde{f} \right\| < \delta \implies \left\| u - \widetilde{u} \right\| > \varepsilon$$.

_Абсолютна похибка_ $$\Delta x \le \vert x - x^\star \vert$$.

_Відносна похибка_ $$\delta x \le \frac{\Delta x}{\vert x \vert}$$, або $$\frac{\Delta x}{\vert x^\star \vert}$$.

_Значущими цифрами_ називаються всі цифри, починаючи з першої ненульової зліва.

_Вірна цифра_ &mdash; це значуща, якщо абсолютна похибка за рахунок відкидання всіх молодших розрядів не перевищує одиниці розряду цієї цифри. Тобто, якщо $$x^\star = \alpha_n\ldots\alpha_0.\alpha_{-1}\ldots\alpha_{-p} \ldots$$, то $$\alpha_{-p}$$ вірна, якщо $$\Delta x \le 10^{-p}$$ (інколи $$\Delta x \le w \cdot 10^{-p}$$, де $$\frac{1}{2} \le w < 1$$ наприклад, $$w = 0.55$$).

<a id="12-підрахунок-похибок-в-еом"></a>
### 1.2. Підрахунок похибок в ЕОМ

Підрахуємо відносну похибку заокруглення числа $$x$$ на ЕОМ з плаваючою комою. В $$\beta$$-ічній системі числення число представляється у вигляді

\begin{equation}
	\label{eq:1.1.5}
	x = \pm (\alpha_1 \beta^{-1} + \alpha_2 \beta^{-2} + \ldots + \alpha_t \beta^{-t} + \ldots) \cdot \beta^p,
\end{equation}

де $$0 \le \alpha_k < \beta$$, $$\alpha_1 \ne 0$$, $$k = 1, 2, \ldots$$

Якщо в ЕОМ $$t$$ розрядів, то при відкиданні молодших розрядів ми оперуємо з наближеним значенням

$$
x^\star = \pm (\alpha_1 \beta^{-1} + \alpha_2 \beta^{-2} + \ldots + \alpha_t \beta^{-t}) \cdot \beta^p
$$

і відповідно похибка заокруглення $$x - x^\star = \pm \beta^p \cdot (\alpha_{t + 1} \beta^{- t - 1} + \ldots)$$. Тоді її можна оцінити так

$$
\begin{aligned}
	\vert x - x^\star \vert &\le \beta^{p - t - 1} \cdot (\beta - 1) \cdot (1 + \beta^{-1} + \ldots) \le \\
	&\le \beta^{p - t - 1} \cdot (\beta - 1) \cdot \frac{1}{1 - \beta^{-1}} = \beta^{p - t}.
\end{aligned}
$$

Якщо в представлені $$\eqref{eq:1.1.5}$$ взяти $$\alpha_1 = 1$$, то $$\vert x \vert \ge \beta^p \cdot \beta^{-1}$$. Звідси остаточно

$$
\delta x \le \frac{\beta^{p - t}}{\beta^{p - 1}} = \beta^{- t + 1}.
$$

При більш точних способах заокруглення можна отримати оцінку $$\delta x \le \frac{1}{2} \cdot \beta^{- t + 1} = \varepsilon$$. Число $$\varepsilon$$ називається &laquo;машинним іпсилон&raquo;. Наприклад, для $$\beta = 2$$, $$t = 24$$, $$\varepsilon = 2^{-24} \approx 10^{-7}$$.

<a id="13-підрахунок-похибок-обчислення-значення-функції"></a>
### 1.3. Підрахунок похибок обчислення значення функції

Нехай задана функція $$y = f(x_1, \ldots, x_n) \in C^1 (\Omega)$$. Необхідно обчислити її значення при наближеному значенні аргументів $$\vec x^\star = (x_1^\star, \ldots, x_n^\star)$$, де $$\vert x_i - x_i^\star \vert \le \Delta x_i$$ та оцінити похибку обчислення значення функції $$y^\star = f(x_1^\star, \ldots, x_n^\star)$$. Маємо

$$
\vert y - y^\star \vert = \left\vert f(\vec x) - f(\vec x^\star) \right\vert = \left\vert \Sum_{i = 1}^n \frac{\partial f}{\partial x_i} (\vec \xi) (x_i - x_i^\star) \right\vert \le \Sum_{i = 1}^n B_i \cdot \Delta x_i,
$$

де $$B_u = \Max_{\vec x \in U} \left\vert \frac{\partial f}{\partial x_i} (\vec x) \right\vert$$.

Тут $$U = \left\{ \vec x = (x_1, \ldots, x_n) : \vert x_i - x_i^\star \vert \le \Delta x_i \right\} \in \Omega$$, $$i = \overline{1, n}$$. Отже з точністю до величин першого порядку малості по $$\Delta x = \Max_i \Delta x_i$$, $$\Delta y = \vert y - y^\star \vert \prec \Sum_{i = 1}^n b_i \cdot \Delta x_i$$, де $$b_i = \left\vert \frac{\partial f}{\partial x_i} (\vec x^\star) \right\vert$$ та &laquo;$$\prec$$&raquo; означає приблизно менше.

Розглянемо похибки арифметичних операцій.

1. Сума: $$y = x_1 + x_2$$, $$x_1, x_2 > 0$$: $$\Delta y \le \Delta x_1 + \Delta x_2$$, $$\delta y \le \frac{\Delta x_1 + \Delta x_2}{x_1 + x_2} \le \Max(\Delta x_1, \delta x_2)$$.

2. Різниця: $$y = x_1 - x_2$$, $$x_1 > x_2 > 0$$: $$\Delta y \le \Delta x_1 + \Delta x_2$$, $$\delta y \le \frac{x_2 \delta x_1 + x_1 \delta x_2}{x_1 - x_2}$$.

	При близьких $$x_1$$, $$x_2$$ зростає відносна похибка (за рахунок втрати вірних цифр).

3. Добуток: $$y = x_1 \cdot x_2$$, $$x_1, x_2 > 0$$: $$\Delta y \prec x_2 \Delta x_1 + x_1 \Delta x_2$$, $$\delta y \le \delta x_1 + \delta x_2$$.

4. Частка $$y = \frac{x_1}{x_2}$$, $$x_1, x_2 > 0$$: $$\Delta y \prec \frac{x_2 \Delta x_1 + x_1 \Delta x_2}{x_2^2}$$, $$\delta y \le \delta x_1 + \delta x_2$$.

	При малих $$x_2$$ зростає абсолютна похибка (за рахунок зростання результату ділення).

_Пряма задача_ аналізу похибок: обчислення $$\Delta y$$, $$\delta y$$ по заданих $$\Delta x_i$$, $$i = \overline{1,n}$$.

_Обернена задача_: знаходження $$\Delta x_i$$, $$i = \overline{1,n}$$ по заданих $$\Delta y$$, $$\delta y$$. Якщо $$n > 1$$, маємо одну умову $$\Sum_{i = 1}^n b_i \cdot \Delta x_i < \varepsilon$$ для багатьох невідомих $$\Delta x_i$$. Вибирають їх із однієї з умов

$$
\forall i: b_i \cdot \Delta x_i < \frac{\varepsilon}{n} \quad \text{або} \quad \Delta x_i < \frac{\varepsilon}{\Sum_{i = 1}^n b_i}.
$$

[Назад до лекцій](README.md)

[Назад на головну](../README.md)
