{% include mathjax %}

<!-- MarkdownTOC -->

- [9. Чисельне інтегрування](#9-чисельне-інтегрування)
	- [9.1. Постановка задачі чисельного інтегрування](#91-постановка-задачі-чисельного-інтегрування)
	- [9.2. Квадратурні формули прямокутників](#92-квадратурні-формули-прямокутників)
	- [9.3. Формула трапеції](#93-формула-трапеції)
	- [9.4. Квадратурна формула Сімпсона](#94-квадратурна-формула-сімпсона)
	- [9.5. Принцип Рунге](#95-принцип-рунге)
	- [9.6. Квадратурні формули найвищого алгебраїчного степеня точності](#96-квадратурні-формули-найвищого-алгебраїчного-степеня-точності)
	- [9.7. Частинні випадки квадратурної формули Гауса](#97-частинні-випадки-квадратурної-формули-гауса)
	- [9.8. Обчислення невласних інтегралів](#98-обчислення-невласних-інтегралів)
	- [9.9. Обчислення кратних інтегралів](#99-обчислення-кратних-інтегралів)

<!-- /MarkdownTOC -->

<a id="9-чисельне-інтегрування"></a>
## 9. Чисельне інтегрування

<a id="91-постановка-задачі-чисельного-інтегрування"></a>
### 9.1. Постановка задачі чисельного інтегрування

Література: 

- ЛМС, стор.&nbsp;13&ndash;14;

- СГ, стор.&nbsp;161&ndash;162.

Нехай потрібно знайти

\begin{equation}
	\label{eq:9.1.1}
	I(f) = \Int_a^b \rho(x) f(x) \diff x,
\end{equation}

де $$f$$ &mdash; задана функція, $$\rho(x) > 0$$ &mdash; деякий ваговий множник. Ця задача часто
вимагає чисельного вирішення, оскільки

- значна кількість інтегралів типу \eqref{eq:9.1.1} не можуть бути обчислені аналітично;

- інформація про функцію $$f$$ може бути задана у вигляді таблиці.

Нагадаємо, що за означенням

\begin{equation}
	I(f) = \Lim_{\Delta \to 0} \Sum_{i = 1}^n \rho(\xi_i) f(\xi_i) \Delta x_i,
\end{equation}

де $$\Delta x_i = x_i - x_{i-1}$$, а $$\{x_i\}_{i = 0}^n$$ &mdash; розбиття проміжку $$[a,b]$$, $$x_i \in [a,b]$$, $$\xi_i \in [x_{i-1}, x_i]$$. 


> **Означення**: Тому візьмемо як наближення таку суму, яка називається _квадратурною формулою_:
> 
> \begin{equation}
> \label{eq:9.1.2}
> I_n(f) = \Sum_{k = 0}^n c_k f(x_k),
> \end{equation}
> де $$x_k$$ &mdash; _вузли квадратурної формули_, а $$c_k$$ &mdash; її _вагові множники_. 

Задача полягає в тим, щоб вибрати $$\{x_n, c_k\}_{k = 0}^n$$, так щоб похибка була найменша:

\begin{equation}
	R_n(f) = I(f) - I_n(f) \to \Min
\end{equation}

> **Означення**: Квадратурну формулу \eqref{eq:9.1.2} називають квадратурною формулою _замкненого типу_, якщо $$x_0 = a$$ та $$x_n = b$$, і _відкритого типу_, якщо $$x_0 > a$$ та $$x_n < b$$.

> **Означення:** Кажуть, що квадратурна формула \eqref{eq:9.1.2} має _$$m$$-ий степінь алгебраїчної точності_, якщо
>
> \begin{equation}
> \forall f \in \pi_m: \quad R_n(f) = 0,
> \end{equation}
> 
> де $$\pi_m$$ &mdash; множина поліномів $$m$$-го степеня, і 
>
> \begin{equation}
> \exists P_{m + 1}(x) \in \pi_{m + 1}: \quad R_n(P_{m + 1}) \ne 0.
> \end{equation}

Цю умову можна замінити умовою 

\begin{equation}
	R_n(x^\alpha) = 0, \quad \alpha = \overline{0, m}, \quad R_n(x^{m + 1}) \ne 0,
\end{equation}

вона більш зручна для перевірки.

Розглянемо деякі підходи до побудови квадратурних формул:

1. _Інтерполяційний_. Він приводить до квадратурних формул інтерполяційного типу. В інтегралі \eqref{eq:9.1.1} покладають $$f(x) \approx L_n(x)$$ по деяких вузлах $$\{x_k\}_{k = 0}^n$$ (вузли фіксовані). Тоді:

	\begin{equation}
		\begin{aligned}
			I_n(f) \approx I(L_n(x)) &= \Int_a^b \rho(x) \Sum_{k = 0}^m \frac{f(x_k) \omega_n(x)}{(x - x_k) \omega_n'(x)} \diff x = \newline
			&= \Sum_{k = 0}^n f(x_k) \Int_a^b \rho(x) \frac{\omega_n(x)}{(x - x_k) \omega_n'(x_k)} \diff x.
		\end{aligned}
	\end{equation}

	Отже вузлами цієї квадратурної формули є вузли інтерполяційного багаточлена, а вагові множники

	\begin{equation}
		c_j = \Int_a^b \rho(x) \frac{\omega_n(x)}{(x - x_k) \omega_n'(x_k)} \diff x
	\end{equation}

2. _Найвищого алгебраїчного степеня точності_. Вибираємо одночасно $$x_k$$ і $$c_k$$ з умови $$R_n(x) = 0$$, $$\alpha = \overline{0, m}$$, щоб $$m$$ було максимальним. Отримуємо систему нелінійних алгебраїчних рівнянь, розв'язавши яку отримуємо квадратурні формули найвищого алгебраїчного степеня точності.

3. _Складені квадратурні формули_. Проміжок $$[a,b]$$ розбиваємо на підпроміжки (наприклад однокової довжини), а потім на кожному проміжку використовуємо, з невеликим степенем, формули з пункту 1 або 2. Наприклад, для формул інтерполяційного типу:

	\begin{equation}
		I(f) = \Sum_{i = 1}^N \Int_{x_{i - 1}}^{x_i} \rho(x) f(x) \diff x \approx \Sum_{i = 1}^N \Sum_{k = 0}^n c_k^i f(x_k^i) = I_h(f).
	\end{equation}

	> **Означення**: Кажуть, що квадратурна формула складеного типу $$I_h$$ має _порядок (степінь) точності $$p$$ по кроку $$h$$_, якщо $$R_h(f) = I(f) - I_h(f) = O(h^p)$$.

4. _Квадратурні формули оптимальні на класі функцій_. Вибираємо $$\{x_k, c_k\}$$ так, щоб досягався 

	\begin{equation}
		\Inf_{\{x_k, c_k\}} \Sup_{f \in F} R_n(f).
	\end{equation}

	Це ми можемо робити, коли знаємо з яким класом функцій маємо справу.

> **Зауваження 1** (_про квадратурні формули інтерполяційного типу_): При підвищенні степеня інтерполяції погіршується якість наближення функції внаслідок розбіжності процесу інтерполяції:
>
> \begin{equation}
> \| f - L_n\|_C \not \xrightarrow[n \to \infty]{} 0.
> \end{equation}
> 
> Але
>
> \begin{equation}
> R_n \xrightarrow[n \to \infty]{} 0.
> \end{equation}
> наприклад, для $$f \in C([a,b])$$. 

І все ж таки розбіжність процесу інтерполювання дає взнаки: 

\begin{equation}
	\Max_k |c_k| \xrightarrow[n \to \infty]{} \infty.
\end{equation}

і це приводить до поганих наслідків чисельного інтегрування. Дійсно, розглянемо випадок, коли функція задана неточними значеннями:

\begin{equation}
	\widetilde{f}(x_k) = f(x_k) + \delta_k, \quad |\delta_k| < \delta.
\end{equation}

Тоді

\begin{equation}
	\delta I_n(f) = I_n (\widetilde{f}) - I_n(f) = \Sum_{k = 0}^n c_k \delta_k.
\end{equation}

Якщо всі $$c_k > 0$$, то

\begin{equation}
	|\delta I| = \Sum_{k = 0}^n c_k |\delta_k| \le \delta \Sum_{k = 0}^n c_k = \delta (b - a).
\end{equation}

При $$\rho \equiv 1$$, якщо підставити $$f \equiv 1$$, то отримаємо 

\begin{equation}
	b - a = \Int_a^b \diff x = \Sum_{k = 0}^n c_k.
\end{equation}

При $$\rho \ne 1$$:

\begin{equation}
	\Sum_{k = 0}^n c_k = \Int_a^b \rho(x) \diff x,
\end{equation}

бо хоча б нульовий степінь точності будь-яка квадратурна формула повинна мати.

Нагадаємо, що

\begin{equation}
	\Max_k |c_k| \xrightarrow[n \to \infty]{} \infty,
\end{equation}

а оскільки $$\Sum c_k > 0$$, то $$\exists c_k > 0$$ і $$\exists c_k < 0$$, тому з ростом $$n$$ зростає $$\vert c_k \vert$$, а відповідно і вплив похибки на результат. Тому не можна використовувати великі степені і використовують складені квадратурні формули.

> **Зауваження 2**: Ясно, що квадратурні формули інтерполяційного типу мають алгебраїчний степінь точності принаймні $$m = n$$, бо ми заміняємо $$f \mapsto L_n$$, а якщо $$f \in \pi_n$$, то $$f \equiv L_n$$. Але виявляється, що для парних $$n$$ та симетричному розташуванні вузлів інтегрування, $$m = n + 1$$, тобто алгебраїчний степінь точності на одиницю вищий степеня інтерполяції.

<a id="92-квадратурні-формули-прямокутників"></a>
### 9.2. Квадратурні формули прямокутників

<a id="93-формула-трапеції"></a>
### 9.3. Формула трапеції

<a id="94-квадратурна-формула-сімпсона"></a>
### 9.4. Квадратурна формула Сімпсона

<a id="95-принцип-рунге"></a>
### 9.5. Принцип Рунге

<a id="96-квадратурні-формули-найвищого-алгебраїчного-степеня-точності"></a>
### 9.6. Квадратурні формули найвищого алгебраїчного степеня точності

<a id="97-частинні-випадки-квадратурної-формули-гауса"></a>
### 9.7. Частинні випадки квадратурної формули Гауса

<a id="98-обчислення-невласних-інтегралів"></a>
### 9.8. Обчислення невласних інтегралів

<a id="99-обчислення-кратних-інтегралів"></a>
### 9.9. Обчислення кратних інтегралів

[Назад до лекцій](README.md)

[Назад на головну](../README.md)
